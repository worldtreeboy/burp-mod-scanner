package com.omnistrike.modules.exploit.omnimap;

import burp.api.montoya.http.message.HttpRequestResponse;

import java.util.List;
import java.util.Map;

/**
 * Callback interface for real-time OmniMap progress updates.
 * The engine calls these methods on a background thread; UI implementations
 * must dispatch to EDT via SwingUtilities.invokeLater().
 */
public interface OmniMapCallback {

    /** General progress update with status message and percentage (0-100) */
    void onProgress(String status, int percent);

    /** DBMS has been auto-detected */
    void onDbmsDetected(String dbms);

    /** List of databases extracted */
    void onDatabasesFound(List<String> databases);

    /** Tables found for a specific database */
    void onTablesFound(String database, List<String> tables);

    /** Columns found for a specific database.table */
    void onColumnsFound(String database, String table, List<String> columns);

    /** A single row extracted during dump */
    void onRowExtracted(String database, String table, Map<String, String> row);

    /** Every HTTP request sent by OmniMap (for the request log) */
    void onRequestSent(HttpRequestResponse reqResp, String payload, String technique, long responseTimeMs);

    /** Extraction complete â€” final results */
    void onComplete(OmniMapResult result);

    /** Error during extraction */
    void onError(String message);
}
